---
/**
 * FIDUBIT - Infrastructure Section
 * Fintech, Blockchain, and OTC services
 */
import ModuleTag from '@/components/ui/ModuleTag.astro';
import GlassPanel from '@/components/ui/GlassPanel.astro';
import { infrastructureServices } from '@/data/site';

const colorClasses = {
  blue: {
    bg: 'bg-blue-500/10',
    text: 'text-blue-500',
    border: 'border-blue-500/20',
    badge: 'border-blue-500/30 text-blue-400 bg-blue-500/5',
    hover: 'from-transparent to-blue-900/5',
  },
  purple: {
    bg: 'bg-purple-500/10',
    text: 'text-purple-500',
    border: 'border-purple-500/20',
    badge: 'border-purple-500/30 text-purple-400 bg-purple-500/5',
    hover: 'from-transparent to-purple-900/5',
  },
  green: {
    bg: 'bg-green-500/10',
    text: 'text-green-500',
    border: 'border-green-500/20',
    badge: 'border-green-500/30 text-green-400 bg-green-500/5',
    hover: 'from-transparent to-green-900/5',
  },
  yellow: {
    bg: 'bg-yellow-500/10',
    text: 'text-yellow-500',
    border: 'border-yellow-500/20',
    badge: 'border-yellow-500/30 text-yellow-400 bg-yellow-500/5',
    hover: 'from-transparent to-yellow-900/5',
  },
  fuchsia: {
    bg: 'bg-fuchsia-500/10',
    text: 'text-fuchsia-500',
    border: 'border-fuchsia-500/20',
    badge: 'border-fuchsia-500/30 text-fuchsia-400 bg-fuchsia-500/5',
    hover: 'from-transparent to-fuchsia-900/5',
  },
};
---

<section id="section-infra" class="relative border-b border-white/5 bg-fidubit-dark">
  <!-- Module Tag -->
  <div class="absolute top-0 right-0 p-4 z-20">
    <ModuleTag number="02" />
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
    {infrastructureServices.map((service, index) => {
      const colors = colorClasses[service.accentColor];
      const delayClass = index === 0 ? '' : index === 1 ? 'sys-delay-100' : 'sys-delay-200';
      
      return (
        <article 
          class:list={[
            "group relative border-r border-b lg:border-b-0 border-white/5 p-10 h-auto min-h-[420px]",
            "flex flex-col justify-between hover:bg-white/5 transition-colors sys-reveal sys-rise",
            delayClass
          ]}
        >
          <!-- Hover Gradient -->
          <div 
            class:list={[
              "absolute inset-0 bg-gradient-to-b opacity-0 group-hover:opacity-100 transition-opacity duration-500",
              colors.hover
            ]}
            aria-hidden="true"
          ></div>
          
          <!-- Dot Pattern Background -->
          <div class="absolute inset-0 dot-pattern" aria-hidden="true"></div>
          
          <!-- Header -->
          <div class="flex justify-between items-start relative z-10">
            <div class:list={["p-3 rounded-lg border", colors.bg, colors.text, colors.border]}>
              <iconify-icon icon={service.icon} width="28"></iconify-icon>
            </div>
            <span class="text-[10px] font-mono text-zinc-600">{service.tag}</span>
          </div>
          
          <!-- Content -->
          <div class="relative z-10 mt-auto">
            <h3 class="text-xl font-medium text-white uppercase tracking-tight mb-3">
              {service.title}
            </h3>
            <p class="text-xs text-zinc-500 font-mono leading-relaxed mb-4">
              {service.description}
            </p>
            
            <!-- Features List -->
            {service.features && (
              <ul class="space-y-2 mb-4">
                {service.features.map((feature) => (
                  <li class="flex items-center text-[10px] font-mono text-zinc-400 gap-2">
                    <iconify-icon icon="solar:check-circle-linear" class={colors.text}></iconify-icon>
                    {feature}
                  </li>
                ))}
              </ul>
            )}
            
            <!-- Badges -->
            {service.badges && (
              <div class="flex gap-2 mt-2 flex-wrap">
                {service.badges.map((badge) => (
                  <span class:list={["text-[9px] border px-2 py-1 rounded", colors.badge]}>
                    {badge}
                  </span>
                ))}
              </div>
            )}
            
            <!-- Liquidity Indicator (for OTC service) -->
            {service.tag === 'LIQUIDITY' && (
              <GlassPanel padding="sm" rounded="md" class="mt-4 border border-white/10">
                <div class="flex justify-between text-[10px] font-mono mb-1">
                  <span class="text-zinc-400">BTC/USDT</span>
                  <span class="text-green-400">Live</span>
                </div>
                <div class="w-full bg-zinc-800 h-1 rounded-full overflow-hidden">
                  <div class="w-2/3 h-full bg-green-500 animate-pulse"></div>
                </div>
              </GlassPanel>
            )}
          </div>
        </article>
      );
    })}
  </div>
</section>
